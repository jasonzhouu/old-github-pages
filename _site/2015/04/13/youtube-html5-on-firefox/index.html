<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  

  
  <title>
    
      YouTube + HTML5 = PROFIT &middot; 周宇盛的博客
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/lanyon.css">
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-precomposed.png">
  <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>


  <body class="theme-base-08">

    

    

    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p>A blog made from an IT lover about IT and other stuff (insert madness here). Based on the awesome <a href="https://github.com/poole/lanyon" target="_blank">Lanyon</a> theme, made by <a href="https://twitter.com/mdo" target="_blank">@mdo</a>.</p>
  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item" href="/">Home</a>

    

    
    
      
        
      
    
      
        
      
    
      
        
          <a class="sidebar-nav-item" href="/about/">About</a>
        
      
    
      
    

    <a class="sidebar-nav-item" href="https://github.com/jasonzhouu/jasonzhouu.github.io">GitHub project</a>
    <span class="sidebar-nav-item">Currently v1.0.3</span>
  </nav>

  <div class="sidebar-item">
    <p>
      &copy; 2016. All rights reserved.
    </p>
  </div>
</div>


    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="/" title="Home">周宇盛的博客</a>
            <small>网页制作 学习笔记 读书笔记</small>
          </h3>
          

        </div>
      </div>

      <div class="container content">
        <div class="post">
  <h1 class="post-title">YouTube + HTML5 = PROFIT</h1>
  <span class="post-date">13 Apr 2015</span>
  <p><em>Everybody loves YouTube, doesn’t it</em>? I love this service too.</p>

<p>I see lots of videos from it and I’m really satisfied with this service.</p>

<p>So, free candies and hugs for everybody, yuppie…
(Notice: you can skip to the <strong>TL;DR</strong> part at the end of the page.
<strong>PRO TIP</strong>: you can search for it in your browser.)</p>

<h2 id="but">But…</h2>

<p>Yeah, bad news here. It uses <em>Adobe’s</em> <strong><em>Flash Player</em></strong>.
The plugin that has just been used for <em>flash games</em> and Youtube.</p>

<p>About the first of them, I can still remember some epic ones, as
<a href="http://www.kongregate.com/games/JuicyBeast/burrito-bison-revenge">Burrito Bison Revenge</a>
and <a href="http://games.adultswim.com/robot-unicorn-attack-heavy-metal-twitchy-online-game.html">Robot Unicorn Attack: Heavy Metal</a>.</p>

<p>For Youtube… well, it’s for Youtube.</p>

<h2 id="so-what">So what…?</h2>

<p>Actually, as you should know, Linux has <em>outdated Flash plugin</em>
(<strong>11.2</strong>, when the upstream one is <strong>11.7</strong>) that is stable but… well,
<em>it’s not updated</em>, fine?</p>

<p>Apart from this, on my main OS (<a href="http://antergos.com">Antergos</a>, an
<a href="http://archlinux.org">ArchLinux</a> with lots of goodies in it and a fully working
desktop manager) I’ve no video thumbnail when shifting the player cursor. And no
 default <em>hardware accelleration</em>. Yup. (But read below for some juice.)
Also, even on Windows I’ve some problems with hardware accelleration (With my
Intel Graphics, I’ve some <em>hardware decoding</em> issues on some formats, as <strong>480p</strong>).</p>

<h3 id="spoiler-nerd-stuff-ahead-more-then-usual-yes-if-youre-not-interested-skip-to-next-paragraph">SPOILER: Nerd stuff ahead… more then usual, yes. If you’re not interested, skip to next paragraph.</h3>
<p>Thanks to <a href="https://github.com/i-rinat/">Rinat Ibragimov</a>, it’s possible to use
an updated version of Flash even on Linux; thanks to his hard work, now we have
avaible a <em>PPAPI-to-NPAPI conversion plugin</em> that allows to use the
<strong>PPAPI Chrome</strong> plugin on Firefox.
If you’re interested, take a look <a href="https://github.com/i-rinat/freshplayerplugin">here</a>,
while you can track hardware decoding specific stuff and progress
<a href="https://github.com/i-rinat/freshplayerplugin/issues/24">here</a>.
This awesome developer also developed the awesome
<a href="https://github.com/i-rinat/libvdpau-va-gl">libvdpau-va-gl</a>, that allows to use
<strong>VA-API</strong> as a <em>VDPAU backend</em> for hardware accelleration.
(As Flash <em>just</em> supports <strong>VDPAU</strong> for hardware accelleration… So many
facepalms for me.).
<em>Translation for human mortals</em>:
<strong><em>you use VA-API for VDPAU accelleration = hardware accelleration for Flash on Intel graphics</em></strong>.
<a href="http://www.webupd8.org/2013/09/adobe-flash-player-hardware.html">Here</a> you’ve
installation tutorial for <em>Ubuntu</em>.
Instead, for installing <strong>libvdpau-va-gl</strong> on <em>ArchLinux</em> you could do something
in a shell like this:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c"># Installing required packages</span>
sudo pacman -S libvdpau-va-gl libva-intel-driver flashplugin
<span class="c"># Enabling HardWare Accelleration for Flash plugin</span>
sudo sed -i <span class="s1">'s/#Enable/Enable/'</span> /etc/adobe/mms.cfg
<span class="c"># Making avaible the driver through environment variables</span>
<span class="nb">echo</span> <span class="s2">"export VDPAU_DRIVER=va_gl"</span> &gt;&gt; .bashrc
<span class="c"># Activate it for the actual session</span>
<span class="nb">export </span><span class="nv">VDPAU_DRIVER</span><span class="o">=</span>va_gl</code></pre></figure>

<p><strong>Notice</strong>: in this way it’ll work just for the user which exports the variable;
to make it default for the whole system, you should create a
<strong><em>/etc/profile.d/vdpau_vaapi.sh</em></strong>
script with this commands:</p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh"><span class="c">#!/bin/sh</span>
<span class="nb">export </span><span class="nv">VDPAU_DRIVER</span><span class="o">=</span>va_gl</code></pre></figure>

<p>This will do the trick.</p>

<h2 id="the-solution-is-html5">The solution is… HTML5!</h2>
<p>As you should know, YouTube has made avaible an <strong>HTML5 player</strong> avaible
<a href="https://www.youtube.com/html5">here</a>.
This make the YouTube experience free from the problems given by Flash Player.
Also, it has <em>no problem</em> in playing <em>all the videos</em> avaible with Flash, it has
<strong>60 FPS videos support</strong> (<em>and Flash does not</em>) and uses
<strong>hardware accelleration</strong> (<em>it should…</em> I can’t be sure about it, as no
related source code is avaible, but it <em>should</em> use <em>hardware accellerated</em>
<strong><em>HTML5 canvas</em></strong>).</p>

<h2 id="but-2">But… #2</h2>
<p>Actually, it fully works just on <em>Chromium/Google Chrome</em>…
<img src="/public/2015-04-13/chromium.png" alt="Fully works on ArchLinux Chromium..." />
While on <em>Firefox</em>…
<img src="/public/2015-04-13/firefox-archlinux.png" alt="Doh #1." />
And on <em>Windows Firefox</em>
<img src="/public/2015-04-13/firefox-windows.png" alt="Doh #2." /></p>

<h2 id="the-final-solution-tldr">The final solution (TL;DR)</h2>

<p>In order to have <strong><em>a fully working HTML5 YouTube player in Firefox</em></strong>, you just
have to open the internal configuration
<a href="about:config">here (Remember, just for  Firefox)</a>, press the big “Yeah, I’ll be
a fine boy” button (<em>can’t remember the proper English text, sorry</em>) set the
flags shown below as suggested (<strong>PRO TIP</strong>: you can use the built-in search bar):</p>

<figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="s">media.mediasource.enabled</span><span class="pi">:</span> <span class="s">true</span>
<span class="s">media.mediasource.mp4.enabled</span><span class="pi">:</span> <span class="s">true</span>
<span class="s">media.mediasource.webm.enabled</span><span class="pi">:</span> <span class="s">true</span>
<span class="s">media.mediasource.youtubeonly</span><span class="pi">:</span> <span class="s">true</span>

<span class="s">media.fragmented-mp4.enabled</span><span class="pi">:</span> <span class="s">true</span>
<span class="s">media.fragmented-mp4.exposed</span><span class="pi">:</span> <span class="s">true</span>
<span class="s">media.fragmented-mp4.ffmpeg.enabled</span><span class="pi">:</span> <span class="s">true</span>
<span class="s">media.fragmented-mp4.gmp.enabled</span><span class="pi">:</span> <span class="s">true</span>
<span class="s">media.fragmented-mp4.use-blank-decoder</span><span class="pi">:</span> <span class="s">false</span></code></pre></figure>

<p>And finally…
<em>Firefox on ArchLinux</em>
<img src="/public/2015-04-13/firefox-archlinux-working.png" alt="Yes #1." />
And on <em>Firefox on Windows</em>.
<img src="/public/2015-04-13/firefox-windows-working.png" alt="Yes #2." /></p>

<h2 id="the-end">The end</h2>
<p>Well, that’s all folks for now.
If it’s interesting, show some love and press the share button I’ve put below
and thank you for reading up to this point.
See you guys!</p>

</div>




<!-- AddToAny BEGIN -->
<div class="a2a_kit a2a_kit_size_32 a2a_default_style">
<a class="a2a_dd" href="https://www.addtoany.com/share_save"></a>
<a class="a2a_button_facebook"></a>
<a class="a2a_button_twitter"></a>
<a class="a2a_button_google_plus"></a>
</div>
<script type="text/javascript" src="//static.addtoany.com/menu/page.js"></script>
<!-- AddToAny END -->



<div class="comments">
	<div id="disqus_thread"></div>
	<script type="text/javascript">

	    var disqus_shortname = 'jasonzhouu';

	    (function() {
	        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
	        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
	        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	    })();

	</script>
	<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>


<div class="related">
  <h2>Related Posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
        
          <a href="/2015/07/25/usb-networking-on-alarm-bbb/">
        
            ArchLinuxARM on BeagleBone Black: getting network working over USB
            <small>25 Jul 2015</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
        
          <a href="/2015/04/28/android-no-thumbnails/">
        
            Android: Preventing Gallery thumbnails creation
            <small>28 Apr 2015</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
        
          <a href="/2015/04/10/introducing-myself/">
        
            Introducing myself
            <small>10 Apr 2015</small>
          </a>
        </h3>
      </li>
    
  </ul>
</div>

      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

    <script>
      (function(document) {
        var toggle = document.querySelector('.sidebar-toggle');
        var sidebar = document.querySelector('#sidebar');
        var checkbox = document.querySelector('#sidebar-checkbox');

        document.addEventListener('click', function(e) {
          var target = e.target;

          if(!checkbox.checked ||
             sidebar.contains(target) ||
             (target === checkbox || target === toggle)) return;

          checkbox.checked = false;
        }, false);
      })(document);
    </script>
    

  </body>
</html>
